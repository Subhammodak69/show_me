{% extends "enduser/base.html" %}
{% load static %}

{% block title %}Home | Show_me{% endblock %}

{% block content %}
<div class="container mt-4" style="max-width: 96%; margin: auto;height: 100%;">
  {% for category, items in categorized_products.items %}
    <div class="category-section mb-5" id="category-{{ category|slugify }}">
      <h3 class="mb-3 text-center text-uppercase">{{ category }}</h3>
      
      <!-- Responsive grid wrapper for overflow scroll on small screens -->
      <div class="row group flex-nowrap flex-md-wrap list-inline-scroll">
        {% for item in items %}
          <div class="col-md-3 col-sm-6 col-4 mb-4 flex-shrink-0 product-col">
            <div class="card h-100 shadow-sm position-relative">
              
              <!-- Image (clickable) -->
              <a href="{% url 'product_details' item.id %}" class="product_img d-block" style="height: 150px; overflow: hidden;">
                <img src="{{ item.photo_url }}" alt="Product Image" class="img-pro" style="width: 100%; height: 100%; object-fit: contain;">
              </a>

              <!-- Product Info -->
              <div class="card-body p-2">
                <a href="{% url 'product_details' item.id %}" class="text-decoration-none text-dark">
                  <h6 class="card-title text-truncate mb-1">{{ item.product.name }}</h6>
                </a>
                <p class="text-muted mb-0">Size: {{ item.size }}</p>
                <p class="text-muted mb-0">Color: {{ item.color }}</p>
                <p class="fw-bold mb-0">â‚¹{{ item.price }}</p>
              </div>

              <!-- Wishlist Icon -->
              <div class="position-absolute top-0 end-0 m-2" style="cursor: pointer;"
                   onclick="event.stopPropagation(); toggle_wishlist_create_update({{ item.id }})">
                {% if item.id in user_wishlist_items_ids %}
                  <i id="wishlist-icon-{{ item.id }}" data-product-id="{{ item.id }}" class="bi bi-heart-fill text-danger"></i>
                {% else %}
                  <i id="wishlist-icon-{{ item.id }}" data-product-id="{{ item.id }}" class="bi bi-heart"></i>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  {% endfor %}
</div>

<!-- ... (your script section unchanged) ... -->

<style>
/* --- Keep your logic styles --- */
.product_img {
  height: 150px;
  overflow: hidden;
  background-color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
}

.img-pro {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.card-body {
  font-size: 12px;
  white-space: nowrap;
  overflow: hidden;
  height: 30%;
}

.category-section {
  scroll-margin-top: 100px;
  transition: opacity 0.4s ease;
}

/* ---- NEW: Responsive scrollable row for small screens ---- */
@media (max-width: 767.98px) {
  .group {
    flex-wrap: nowrap !important;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    padding-bottom: 4px;
    /* Optionally hide the scroll bar */
    /* scrollbar-color: transparent transparent; */
  }
  .product-col {
    flex: 0 0 33.3333%;
    max-width: 33.3333%;
    min-width: 135px;       /* min width for each card, tune as needed */
    box-sizing: border-box;
    padding-right: 10px;
    padding-left: 0;
  }
  .card {
    min-width: 115px;       /* Make card visually compact */
    max-width: 160px;
    font-size: 12px;
  }
  .product_img {
    height: 85px;
  }
  .card-body {
    font-size: 11px;
    padding: 0.25rem 0.4rem !important; /* tighter for mobile */
  }
}

/* Optional, for a cleaner scroll bar (uncomment if wanted) */
/*
@media (max-width: 767.98px) {
  .group::-webkit-scrollbar {
    display: none;
  }
}
*/

</style>
{% endblock %}
