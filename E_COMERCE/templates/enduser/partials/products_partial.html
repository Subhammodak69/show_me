{% for product in product_items %}
<div class="card pro-cards p-2 text-center position-relative flex-shrink-0" 
     style="    min-width: 150px;
    width: 100%;
    max-width: 200px;
    margin: 15px auto;">
  <!-- EXACT SAME product card HTML as above -->
  <i id="wishlist-icon-{{ product.id }}" 
     class="bi bi-heart position-absolute top-0 end-0 m-2 p-1 wishlist-icon"
     style="font-size: 18px; z-index: 10; cursor: pointer; width: 30px;height: 30px;"
    data-product-id="{{ product.id }}" 

      {% if user.is_authenticated %}
          onclick="toggle_wishlist_create_update({{ product.id }})"
      {% else %}
          onclick="window.location.href='{% url 'log_in' %}'"
      {% endif %}
     title="Add to wishlist"></i>
  <div class="d-flex align-items-center justify-content-center" style="margin: auto;width: 130px;height: 150px;">
    <img src="{{ product.photo_url }}" alt="{{ product.title }}" class="card-img-top mx-auto rounded"
        style="width: 100%;height: 100%;object-fit: cover;">
  </div>
  
  <div class="card-body px-0">
    <div class="text-muted" style="font-size:14px;">⭐{{ product.rating }} | ({{product.rating_count}})</div>
    <div class="card-title" 
         style="
           display: -webkit-box;
           -webkit-line-clamp: 3;
           -webkit-box-orient: vertical;
           overflow: hidden;
           text-overflow: ellipsis;
           max-height: 40px;
           font-size:15px; 
           color: blue; 
           cursor:pointer;
           line-height: 1.3em;
         "
         onclick="window.location.href='{% url 'product_details' product.id %}'">
      {{ product.product_name }}
    </div>
    {% if product.price_data.sale_price == product.price_data.original_price %}
      <div class="card-text text-muted" style="font-size:14px;">₹{{ product.price_data.original_price }}</div>
    {% else %}
    <span style="text-decoration: line-through;font-size:14px; color: #dc3545;">₹{{ product.price_data.original_price }}</span>  
    <span style="font-size:14px;">₹{{ product.price_data.sale_price }}</span>
    {% endif %}
  </div>
</div>
{% endfor %}

<!-- Add new trigger for next page -->
{% if initial_data.has_next %}
  <div id="infinite-scroll-trigger" 
      hx-get="{% url 'category_products_list_ajax' category_id %}?page={{ initial_data.next_page }}"
      hx-target="#product-grid" 
      hx-swap="beforeend"
      hx-trigger="revealed"
      hx-indicator="#loading"
      style="height: 20px;"></div>
  <div id="loading" class="text-center py-4" style="display: none;">
    <div class="spinner-border spinner-border-sm me-2" role="status"></div>
    Loading more products...
  </div>
{% endif %}
