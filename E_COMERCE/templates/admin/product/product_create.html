{% extends 'admin/home.html' %}
{% load static %}
{% block title %}Create Subcategory{% endblock %}
{% block content %}

<div class="mb-3 text-center">
  <h2 class="mb-4">Product Create</h2>
</div>
<div class="container" style="padding: 40px;max-width: 600px;background: whitesmoke;border-radius: 10px;">
<form id="productForm">
  {% csrf_token %}

  <!-- Subcategory -->
  <div class="mb-3">
    <label class="form-label">Subcategory</label>
    <select name="subcategory" class="form-select" required>
      <option value="" disabled selected>Select a subcategory</option>
      {% for sub in subcategories %}
        <option value="{{ sub.id }}">{{ sub.name }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="modal-body">
    <div class="mb-3">
      <label class="form-label">Product Name</label>
      <input type="text" name="name" value="{{ product.name|default:'' }}" class="form-control" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Description</label>
      <textarea name="description" class="form-control" required>{{ product.description|default:'' }}</textarea>
    </div>

  </div>

  <div class="modal-footer">
    <button type="submit" class="btn btn-success">Create</button>
  </div>
</form>
</div>

<script>
  document.getElementById('productForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const form = e.target;
    const formData = new FormData(form);

    fetch("{{ request.path }}", {
      method: "POST",
      headers: {
        "X-CSRFToken": '{{ csrf_token }}'
      },
      body: formData
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        window.location.href = "{% url 'product' %}";
      } else {
        alert("Error: " + data.error);
      }
    });
  });
</script>

{% endblock %}